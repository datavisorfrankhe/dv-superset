{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;};import { SupersetClient } from '@superset-ui/core';\n// update datasources index for Dashboard\nexport var DatasourcesAction;\n(function (DatasourcesAction) {\n  DatasourcesAction[\"SET_DATASOURCES\"] = \"SET_DATASOURCES\";\n  DatasourcesAction[\"SET_DATASOURCE\"] = \"SET_DATASOURCE\";\n})(DatasourcesAction || (DatasourcesAction = {}));\nexport function setDatasources(datasources) {\n  return {\n    type: DatasourcesAction.SET_DATASOURCES,\n    datasources };\n\n}\nexport function setDatasource(datasource, key) {\n  return {\n    type: DatasourcesAction.SET_DATASOURCE,\n    key,\n    datasource };\n\n}\nexport function fetchDatasourceMetadata(key) {\n  return (dispatch, getState) => {\n    const { datasources } = getState();\n    const datasource = datasources[key];\n    if (datasource) {\n      return dispatch(setDatasource(datasource, key));\n    }\n    return SupersetClient.get({\n      endpoint: `/superset/fetch_datasource_metadata?datasourceKey=${key}` }).\n    then(({ json }) => dispatch(setDatasource(json, key)));\n  };\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(DatasourcesAction, \"DatasourcesAction\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/actions/datasources.ts\");reactHotLoader.register(setDatasources, \"setDatasources\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/actions/datasources.ts\");reactHotLoader.register(setDatasource, \"setDatasource\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/actions/datasources.ts\");reactHotLoader.register(fetchDatasourceMetadata, \"fetchDatasourceMetadata\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/actions/datasources.ts\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/dashboard/actions/datasources.ts"],"names":[],"mappings":"uSAmBA,SAAS,cAAT,QAA+B,mBAA/B;AAGA;AACA,OAAA,IAAY,iBAAZ;AAAA,CAAA,UAAY,iBAAZ,EAA6B;AAC3B,EAAA,iBAAA,CAAA,iBAAA,CAAA,GAAA,iBAAA;AACA,EAAA,iBAAA,CAAA,gBAAA,CAAA,GAAA,gBAAA;AACD,CAHD,EAAY,iBAAiB,KAAjB,iBAAiB,GAAA,EAAA,CAA7B;AAgBA,OAAM,SAAU,cAAV,CAAyB,WAAzB,EAAyD;AAC7D,SAAO;AACL,IAAA,IAAI,EAAE,iBAAiB,CAAC,eADnB;AAEL,IAAA,WAFK,EAAP;;AAID;AAED,OAAM,SAAU,aAAV,CAAwB,UAAxB,EAAgD,GAAhD,EAA2D;AAC/D,SAAO;AACL,IAAA,IAAI,EAAE,iBAAiB,CAAC,cADnB;AAEL,IAAA,GAFK;AAGL,IAAA,UAHK,EAAP;;AAKD;AAED,OAAM,SAAU,uBAAV,CAAkC,GAAlC,EAA6C;AACjD,SAAO,CAAC,QAAD,EAAqB,QAArB,KAAkD;AACvD,UAAM,EAAE,WAAF,KAAkB,QAAQ,EAAhC;AACA,UAAM,UAAU,GAAG,WAAW,CAAC,GAAD,CAA9B;AAEA,QAAI,UAAJ,EAAgB;AACd,aAAO,QAAQ,CAAC,aAAa,CAAC,UAAD,EAAa,GAAb,CAAd,CAAf;AACD;AAED,WAAO,cAAc,CAAC,GAAf,CAAmB;AACxB,MAAA,QAAQ,EAAE,qDAAqD,GAAG,EAD1C,EAAnB;AAEJ,IAAA,IAFI,CAEC,CAAC,EAAE,IAAF,EAAD,KAAc,QAAQ,CAAC,aAAa,CAAC,IAAD,EAAqB,GAArB,CAAd,CAFvB,CAAP;AAGD,GAXD;AAYD,C,iLA5CW,iB,0IAgBI,c,uIAOA,a,sIAQA,uB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Dispatch } from 'redux';\nimport { SupersetClient } from '@superset-ui/core';\nimport { Datasource, RootState } from 'src/dashboard/types';\n\n// update datasources index for Dashboard\nexport enum DatasourcesAction {\n  SET_DATASOURCES = 'SET_DATASOURCES',\n  SET_DATASOURCE = 'SET_DATASOURCE',\n}\n\nexport type DatasourcesActionPayload =\n  | {\n      type: DatasourcesAction.SET_DATASOURCES;\n      datasources: Datasource[] | null;\n    }\n  | {\n      type: DatasourcesAction.SET_DATASOURCE;\n      key: Datasource['uid'];\n      datasource: Datasource;\n    };\n\nexport function setDatasources(datasources: Datasource[] | null) {\n  return {\n    type: DatasourcesAction.SET_DATASOURCES,\n    datasources,\n  };\n}\n\nexport function setDatasource(datasource: Datasource, key: string) {\n  return {\n    type: DatasourcesAction.SET_DATASOURCE,\n    key,\n    datasource,\n  };\n}\n\nexport function fetchDatasourceMetadata(key: string) {\n  return (dispatch: Dispatch, getState: () => RootState) => {\n    const { datasources } = getState();\n    const datasource = datasources[key];\n\n    if (datasource) {\n      return dispatch(setDatasource(datasource, key));\n    }\n\n    return SupersetClient.get({\n      endpoint: `/superset/fetch_datasource_metadata?datasourceKey=${key}`,\n    }).then(({ json }) => dispatch(setDatasource(json as Datasource, key)));\n  };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}