{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";var _jsxFileName = \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SaveQuery.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { Row, Col, Input, TextArea } from 'src/common/components';\nimport { t, styled } from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport { Form, FormItem } from 'src/components/Form';\nimport Modal from 'src/components/Modal';\nimport Icons from 'src/components/Icons';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst Styles = styled.span`\n  span[role='img'] {\n    display: flex;\n    margin: 0;\n    color: ${({ theme }) => theme.colors.grayscale.base};\n    svg {\n      vertical-align: -${({ theme }) => theme.gridUnit * 1.25}px;\n      margin: 0;\n    }\n  }\n`;\nexport default function SaveQuery({ query, defaultLabel = t('Undefined'), onSave = () => {}, onUpdate, saveQueryWarning = null }) {\n  const [description, setDescription] = useState(query.description || '');\n  const [label, setLabel] = useState(defaultLabel);\n  const [showSave, setShowSave] = useState(false);\n  const isSaved = !!query.remoteId;\n  const queryPayload = () => ({\n    ...query,\n    title: label,\n    description });\n\n  const close = () => {\n    setShowSave(false);\n  };\n  const onSaveWrapper = () => {\n    onSave(queryPayload());\n    close();\n  };\n  const onUpdateWrapper = () => {\n    onUpdate(queryPayload());\n    close();\n  };\n  const onLabelChange = (e) => {\n    setLabel(e.target.value);\n  };\n  const onDescriptionChange = (e) => {\n    setDescription(e.target.value);\n  };\n  const toggleSave = () => {\n    setShowSave(!showSave);\n  };\n  const renderModalBody = () => ___EmotionJSX(Form, { layout: \"vertical\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 67, columnNumber: 36 } },\n  ___EmotionJSX(Row, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 68, columnNumber: 7 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 69, columnNumber: 9 } },\n  ___EmotionJSX(FormItem, { label: t('Name'), __self: this, __source: { fileName: _jsxFileName, lineNumber: 70, columnNumber: 11 } },\n  ___EmotionJSX(Input, { type: \"text\", value: label, onChange: onLabelChange, __self: this, __source: { fileName: _jsxFileName, lineNumber: 71, columnNumber: 13 } })))),\n\n\n\n  ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 75, columnNumber: 7 } }),\n  ___EmotionJSX(Row, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 76, columnNumber: 7 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 77, columnNumber: 9 } },\n  ___EmotionJSX(FormItem, { label: t('Description'), __self: this, __source: { fileName: _jsxFileName, lineNumber: 78, columnNumber: 11 } },\n  ___EmotionJSX(TextArea, { rows: 4, value: description, onChange: onDescriptionChange, __self: this, __source: { fileName: _jsxFileName, lineNumber: 79, columnNumber: 13 } })))),\n\n\n\n  saveQueryWarning && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 84, columnNumber: 11 } }),\n  ___EmotionJSX(\"div\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 85, columnNumber: 11 } },\n  ___EmotionJSX(Row, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 86, columnNumber: 13 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 87, columnNumber: 15 } },\n  ___EmotionJSX(\"small\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 88, columnNumber: 17 } }, saveQueryWarning))),\n\n\n  ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 91, columnNumber: 13 } }))));\n\n\n\n  return ___EmotionJSX(Styles, { className: \"SaveQuery\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 95, columnNumber: 13 } },\n  ___EmotionJSX(Button, { buttonSize: \"small\", onClick: toggleSave, __self: this, __source: { fileName: _jsxFileName, lineNumber: 96, columnNumber: 7 } },\n  ___EmotionJSX(Icons.Save, { iconSize: \"xl\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 97, columnNumber: 9 } }),\n  isSaved ? t('Save') : t('Save as')),\n\n  ___EmotionJSX(Modal, { className: \"save-query-modal\", onHandledPrimaryAction: onSaveWrapper, onHide: close, primaryButtonName: isSaved ? t('Save') : t('Save as'), width: \"620px\", show: showSave, title: ___EmotionJSX(\"h4\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 100, columnNumber: 189 } }, t('Save query')), footer: [\n    ___EmotionJSX(React.Fragment, null,\n    ___EmotionJSX(Button, { onClick: close, \"data-test\": \"cancel-query\", cta: true, __self: this, __source: { fileName: _jsxFileName, lineNumber: 102, columnNumber: 13 } },\n    t('Cancel')),\n\n    ___EmotionJSX(Button, { buttonStyle: isSaved ? undefined : 'primary', onClick: onSaveWrapper, className: \"m-r-3\", cta: true, __self: this, __source: { fileName: _jsxFileName, lineNumber: 105, columnNumber: 13 } },\n    isSaved ? t('Save as new') : t('Save')),\n\n    isSaved && ___EmotionJSX(Button, { buttonStyle: \"primary\", onClick: onUpdateWrapper, className: \"m-r-3\", cta: true, __self: this, __source: { fileName: _jsxFileName, lineNumber: 108, columnNumber: 26 } },\n    t('Update')))], __self: this, __source: { fileName: _jsxFileName, lineNumber: 100, columnNumber: 7 } },\n\n\n\n  renderModalBody()));\n\n\n}__signature__(SaveQuery, \"useState{[description, setDescription](query.description || '')}\\nuseState{[label, setLabel](defaultLabel)}\\nuseState{[showSave, setShowSave](false)}\");;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(Styles, \"Styles\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SaveQuery.tsx\");reactHotLoader.register(SaveQuery, \"SaveQuery\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SaveQuery.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SaveQuery.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { Row, Col, Input, TextArea } from 'src/common/components';\nimport { t, styled } from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport { Form, FormItem } from 'src/components/Form';\nimport Modal from 'src/components/Modal';\nimport Icons from 'src/components/Icons';\n\nconst Styles = styled.span`\n  span[role='img'] {\n    display: flex;\n    margin: 0;\n    color: ${({ theme }) => theme.colors.grayscale.base};\n    svg {\n      vertical-align: -${({ theme }) => theme.gridUnit * 1.25}px;\n      margin: 0;\n    }\n  }\n`;\n\ninterface SaveQueryProps {\n  query: any;\n  defaultLabel: string;\n  onSave: (arg0: QueryPayload) => void;\n  onUpdate: (arg0: QueryPayload) => void;\n  saveQueryWarning: string | null;\n}\n\ntype QueryPayload = {\n  autorun: boolean;\n  dbId: number;\n  description?: string;\n  id?: string;\n  latestQueryId: string;\n  queryLimit: number;\n  remoteId: number;\n  schema: string;\n  schemaOptions: Array<{\n    label: string;\n    title: string;\n    value: string;\n  }>;\n  selectedText: string | null;\n  sql: string;\n  tableOptions: Array<{\n    label: string;\n    schema: string;\n    title: string;\n    type: string;\n    value: string;\n  }>;\n  title: string;\n};\n\nexport default function SaveQuery({\n  query,\n  defaultLabel = t('Undefined'),\n  onSave = () => {},\n  onUpdate,\n  saveQueryWarning = null,\n}: SaveQueryProps) {\n  const [description, setDescription] = useState<string>(\n    query.description || '',\n  );\n  const [label, setLabel] = useState<string>(defaultLabel);\n  const [showSave, setShowSave] = useState<boolean>(false);\n  const isSaved = !!query.remoteId;\n\n  const queryPayload = () => ({\n    ...query,\n    title: label,\n    description,\n  });\n\n  const close = () => {\n    setShowSave(false);\n  };\n\n  const onSaveWrapper = () => {\n    onSave(queryPayload());\n    close();\n  };\n\n  const onUpdateWrapper = () => {\n    onUpdate(queryPayload());\n    close();\n  };\n\n  const onLabelChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setLabel(e.target.value);\n  };\n\n  const onDescriptionChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setDescription(e.target.value);\n  };\n\n  const toggleSave = () => {\n    setShowSave(!showSave);\n  };\n\n  const renderModalBody = () => (\n    <Form layout=\"vertical\">\n      <Row>\n        <Col xs={24}>\n          <FormItem label={t('Name')}>\n            <Input type=\"text\" value={label} onChange={onLabelChange} />\n          </FormItem>\n        </Col>\n      </Row>\n      <br />\n      <Row>\n        <Col xs={24}>\n          <FormItem label={t('Description')}>\n            <TextArea\n              rows={4}\n              value={description}\n              onChange={onDescriptionChange}\n            />\n          </FormItem>\n        </Col>\n      </Row>\n      {saveQueryWarning && (\n        <>\n          <br />\n          <div>\n            <Row>\n              <Col xs={24}>\n                <small>{saveQueryWarning}</small>\n              </Col>\n            </Row>\n            <br />\n          </div>\n        </>\n      )}\n    </Form>\n  );\n\n  return (\n    <Styles className=\"SaveQuery\">\n      <Button buttonSize=\"small\" onClick={toggleSave}>\n        <Icons.Save iconSize=\"xl\" />\n        {isSaved ? t('Save') : t('Save as')}\n      </Button>\n      <Modal\n        className=\"save-query-modal\"\n        onHandledPrimaryAction={onSaveWrapper}\n        onHide={close}\n        primaryButtonName={isSaved ? t('Save') : t('Save as')}\n        width=\"620px\"\n        show={showSave}\n        title={<h4>{t('Save query')}</h4>}\n        footer={[\n          <>\n            <Button onClick={close} data-test=\"cancel-query\" cta>\n              {t('Cancel')}\n            </Button>\n            <Button\n              buttonStyle={isSaved ? undefined : 'primary'}\n              onClick={onSaveWrapper}\n              className=\"m-r-3\"\n              cta\n            >\n              {isSaved ? t('Save as new') : t('Save')}\n            </Button>\n            {isSaved && (\n              <Button\n                buttonStyle=\"primary\"\n                onClick={onUpdateWrapper}\n                className=\"m-r-3\"\n                cta\n              >\n                {t('Update')}\n              </Button>\n            )}\n          </>,\n        ]}\n      >\n        {renderModalBody()}\n      </Modal>\n    </Styles>\n  );\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}